package edu.pnu.service;

import java.util.Date;
import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import edu.pnu.domain.Logs;
import edu.pnu.domain.Members;
import edu.pnu.repository.LogRepository;
import edu.pnu.repository.MemberRepository;

@Service
public class MemberService {
	
	
	private MemberRepository memRepo;
	private LogRepository logRepo;
	
	@Autowired
	public MemberService(MemberRepository memRepo, LogRepository logRepo) {
		this.memRepo = memRepo;
		this.logRepo = logRepo;
	}

	public List<Members> getMembers(){
		try {
			List<Members> list = memRepo.findAll();
			logRepo.save(new Logs("Get", "getMembers()", true));
			return list;
		} catch(Exception e) {
			logRepo.save(new Logs("Get", "getMembers()", false));
			System.out.println("false");
			return null;
		}
		
	}

	public Members getMember(String id) {
		try {
			Members m = memRepo.findById(id).get();
			logRepo.save(new Logs("Get", "getMember()", true));
			return m;
		} catch(Exception e) {
			logRepo.save(new Logs("Get", "getMember()", false));
			System.out.println("해당하는 id가 없습니다.");
			return null;
		}
		
	}

	public Members addMember(Members member) {
		try {
			Members m = memRepo.save(new Members(
					member.getId(),
					member.getPass(),
					member.getName(),
					new Date()
					));
			logRepo.save(new Logs("Post", "addMember()", true));
			return m;
		} catch(Exception e) {
			logRepo.save(new Logs("Post", "addMember()", false));
		}
		

	}

	public Members updateMember(Members member) {
		Members m = memRepo.findById(member.getId()).get();
		m.setPass("1234Cc");
		m.setName("NameCh");
		m.setRegidate(new Date());
		memRepo.save(m);
		return m;
	}

	public Members deleteMember(String id) {
		Members m = memRepo.findById(id).get();
		memRepo.deleteById(id);
		return m;
	}

}
